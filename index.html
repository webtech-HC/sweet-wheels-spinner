<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>Sweet Wheels ‚Äî Dessert Truck (Knoxville)</title>
<meta name="description" content="Treat Yourself ‚Äî Sweet Wheels Desserts. Today‚Äôs location, menu highlights, and Sweet Deals spinner." />

<link rel="preconnect" href="https://fonts.googleapis.com">
<link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;600;700&family=Inter:wght@400;500;700&display=swap" rel="stylesheet">

<style>
:root{
  --ink:#3B3A40; --muted:#8E90A0;
  --cream:#FFF7EF; --lemon:#FFE3A1; --straw:#F8B8C9;
  --mint:#BFEEDF; --blue:#BFD6FF; --lav:#DCC6FF;
  --panel:#ffffff; --line:rgba(30,33,36,.10); --ring:rgba(191,214,255,.55);
}
*{box-sizing:border-box}
html,body{margin:0;background:linear-gradient(120deg,var(--cream),#fff);color:var(--ink);font-family:Inter,system-ui,Segoe UI,Arial,sans-serif}
h1,h2,h3{font-family:Fredoka,system-ui,Arial,sans-serif;margin:.2rem 0 .6rem}
h1{font-size:clamp(1.8rem,3.2vw,3rem);line-height:1.1}
h2{font-size:clamp(1.3rem,2.1vw,1.8rem)}
h3{font-size:1.1rem}
p{line-height:1.5}
a{color:inherit}
.wrap{max-width:1100px;margin:0 auto;padding:clamp(14px,2vw,22px)}
.section{padding:clamp(18px,3.2vw,40px) 0}
.sub{color:var(--muted)}
.accent{color:#5b5b66}

/* Skip link */
.skip{position:absolute;left:-9999px;top:0;background:#fff;padding:.4rem .6rem;border-radius:8px;z-index:999}
.skip:focus{left:10px;box-shadow:0 6px 16px rgba(0,0,0,.12)}

/* Buttons */
.btn{
  background:var(--straw); border:1px solid var(--line); border-radius:18px; padding:.7rem 1rem;
  box-shadow:0 6px 18px rgba(239,154,174,.18), inset 0 2px 0 rgba(255,255,255,.85);
  text-decoration:none;display:inline-flex;gap:.5rem;align-items:center;font-weight:700;color:inherit
}
.btn:hover{filter:saturate(1.02);transform:translateY(-1px)}
.btn.line{background:#fff}
.btn.mini{padding:.5rem .8rem;border-radius:14px}
.mt{margin-top:1rem}
.muted{color:var(--muted)}
.small{font-size:.9rem}

/* Topbar */
.topbar{position:sticky;top:0;background:rgba(255,255,255,.8);backdrop-filter:blur(8px);border-bottom:1px solid var(--line);z-index:50}
.topbar .wrap{display:flex;align-items:center;justify-content:space-between;gap:12px}
.pill{background:#fff;border:1px solid var(--line);border-radius:999px;padding:.35rem .7rem;box-shadow:0 4px 16px rgba(0,0,0,.06)}
.mini-nav a{margin-left:8px;text-decoration:none;padding:.2rem .4rem;border-radius:8px}
.mini-nav a:hover{background:rgba(0,0,0,.04)}
details.hours{display:inline-block;position:relative;margin-right:8px}
details.hours summary{list-style:none;cursor:pointer;padding:.2rem .4rem;border-radius:8px}
details.hours[open] summary{background:rgba(0,0,0,.04)}
.hours-card{display:none;position:absolute;right:0;top:calc(100% + 6px);min-width:220px;z-index:80}
details.hours[open] .hours-card{display:block}
.hours-list{margin:0;padding:.2rem .2rem .2rem 1.2rem}
.hours-list li{line-height:1.6}

/* Hero */
.hero{padding:28px 0 8px}
.hero-grid{display:grid;grid-template-columns:1.05fr .95fr;gap:26px;align-items:center}
.hero-art{display:grid;place-items:center}
.softserve{width:min(440px,90%);filter:drop-shadow(0 18px 35px rgba(40,30,20,.14))}
.cta-row{display:flex;gap:12px;flex-wrap:wrap}

/* Cards / Menu */
.cards{display:grid;grid-template-columns:repeat(auto-fit,minmax(240px,1fr));gap:16px;list-style:none;padding:0;margin:0}
.card{background:var(--panel);border:1px solid var(--line);border-radius:22px;padding:14px 16px;box-shadow:0 18px 40px rgba(32,33,36,.10), inset 0 2px 0 rgba(255,255,255,.85)}
.card h3{margin:0 0 .35rem}
.card p{margin:.25rem 0}
.card .price{display:flex;align-items:center;gap:.4rem;margin-top:.35rem;font-weight:700}
.badge{background:var(--mint);border:1px solid #9FD7C6;border-radius:10px;padding:2px 8px;font-weight:700}
.badge.warn{background:#FFE3E9;border-color:#F4C2CF}

/* Deals / Spinner (Winwheel) */
.deals-grid{display:grid;grid-template-columns:1.1fr .9fr;gap:22px;align-items:center}
.spinner{display:grid;place-items:center;gap:12px}
.stage{position:relative;display:grid;place-items:center;padding:18px}
.rim{position:absolute;inset:0;border-radius:28px;
     box-shadow:0 26px 60px rgba(32,33,36,.14), inset 0 8px 0 rgba(255,255,255,.85);
     background:radial-gradient(120px 80px at 50% 40%,#fff 0%, #fff 50%, rgba(0,0,0,.02) 100%)}
.canvas-wrap{position:relative;display:inline-block;border-radius:50%;
  padding:14px;background:#fff;
  box-shadow:0 18px 38px rgba(0,0,0,.12), inset 0 4px 0 rgba(255,255,255,.85);
  width:min(420px,80vw)}
#wheel{display:block;width:100%;height:auto}
.pointer{position:absolute;top:-14px;left:50%;transform:translateX(-50%);width:0;height:0;
  border-left:14px solid transparent;border-right:14px solid transparent;border-bottom:22px solid #ffb2c4;
  filter:drop-shadow(0 6px 10px rgba(0,0,0,.12))}
.controls{display:flex;gap:10px;flex-wrap:wrap;justify-content:center}
.coupon{font-family:ui-monospace,Menlo,Consolas,monospace;background:#f7f7f9;border:1px dashed #cfcfd8;border-radius:10px;padding:6px 8px;display:inline-block;cursor:pointer}

/* Forms / IG */
.form input,.form textarea{width:100%;padding:.7rem;border:1px solid var(--line);border-radius:14px;background:#fff;box-shadow:inset 0 2px 0 rgba(255,255,255,.8)}
.form label{display:grid;gap:6px;margin-bottom:10px}
.form input:focus,.form textarea:focus{outline:2px solid var(--ring);outline-offset:2px}
.grid2{display:grid;grid-template-columns:1fr 1fr;gap:16px}
.quote{margin:0 0 12px}
.ig{list-style:none;padding:0;margin:6px 0;display:grid;grid-template-columns:repeat(3,1fr);gap:8px}
.ig .ph{background:linear-gradient(120deg,#fff,var(--cream));border:1px solid var(--line);border-radius:18px;aspect-ratio:1;box-shadow:inset 0 2px 0 rgba(255,255,255,.8)}

/* Footer + Sticky CTA */
.footer{border-top:1px solid var(--line);padding:18px 0;background:#fff}
.sticky-cta{position:sticky;bottom:0;display:none;gap:8px;justify-content:space-around;padding:8px;
  padding-bottom:calc(8px + env(safe-area-inset-bottom));
  background:rgba(255,255,255,.85);backdrop-filter:blur(8px);border-top:1px solid var(--line);z-index:60}
.sticky-cta .btn{box-shadow:none}

/* Responsive */
@media (max-width:900px){
  .hero-grid{grid-template-columns:1fr}
  .deals-grid{grid-template-columns:1fr}
  .grid2{grid-template-columns:1fr}
  .sticky-cta{display:flex}
}
/* Focus */
:focus-visible{outline:3px solid var(--ring);outline-offset:2px}
</style>
</head>
<body>
<a class="skip" href="#menu">Skip to content</a>

<section id="app" class="site">
  <!-- Top / Utility -->
  <header class="topbar" role="banner">
    <div class="wrap">
      <span class="pill" id="today-pill" aria-live="polite">Today: ‚Ä¶</span>

      <nav class="mini-nav" aria-label="Utility">
        <details class="hours" id="hoursDrop">
          <summary aria-controls="hoursList">Hours</summary>
          <div class="card hours-card">
            <ul id="hoursList" class="hours-list"></ul>
          </div>
        </details>
        <a id="orderLink" href="#order" class="btn mini">Order Ahead</a>
      </nav>
    </div>
  </header>

  <!-- Hero -->
  <section class="hero" aria-labelledby="hero-title">
    <div class="wrap hero-grid">
      <div class="hero-copy">
        <h1 id="hero-title">Treat Yourself ‚Äî <span class="accent">Sweet Wheels Desserts</span></h1>
        <p class="sub">Light, bright, and fluffy treats on wheels. üç¶</p>
        <div class="cta-row">
          <a class="btn" href="#find">Find Today‚Äôs Location</a>
          <a class="btn line" href="#order">Order Ahead</a>
        </div>
      </div>
      <!-- cleaner soft-serve illustration -->
      <div class="hero-art" aria-hidden="true">
        <svg class="softserve" viewBox="0 0 400 400" role="img" aria-label="Soft-serve cone">
          <defs>
            <linearGradient id="cone" x1="0" x2="0" y1="0" y2="1">
              <stop offset="0%" stop-color="#FFD9A6"/><stop offset="100%" stop-color="#E9B877"/>
            </linearGradient>
            <linearGradient id="cream" x1="0" x2="0" y1="0" y2="1">
              <stop offset="0%" stop-color="#FFE5ED"/><stop offset="100%" stop-color="#F8B8C9"/>
            </linearGradient>
          </defs>
          <g transform="translate(50,10)">
            <path d="M145 110c-30-8-40-36-10-50 0-20 26-28 42-16 20-20 52-8 52 16 26 4 34 36 8 50 16 18 4 42-24 46-18 4-44 4-68-2-28-8-34-26 0-44z" fill="url(#cream)" stroke="#F0A7B7" stroke-opacity=".4"/>
            <path d="M60 220l200 0-26 120a16 16 0 0 1-16 12H102a16 16 0 0 1-16-12L60 220z" fill="url(#cone)" stroke="#D6A165"/>
            <path d="M86 244h148M80 272h160M74 300h172M68 328h184" stroke="#E5BA79" stroke-width="8" opacity=".7"/>
          </g>
        </svg>
      </div>
    </div>
  </section>

  <!-- Menu Highlights -->
  <section id="menu" class="section" aria-labelledby="menu-title">
    <div class="wrap">
      <h2 id="menu-title">Menu Highlights</h2>
      <ul class="cards">
        <li class="card"><h3>Strawberry Shortcake Cup</h3><p>Buttery crumble, fresh berries, whipped cream.</p><p class="price">$6.50 <span class="badge">V</span></p></li>
        <li class="card"><h3>Birthday-Cake Soft-Serve</h3><p>Sprinkles & vanilla-confetti swirl.</p><p class="price">$4.75 <span class="badge">GF</span></p></li>
        <li class="card"><h3>Triple-Chocolate Brownie</h3><p>Fudgey center, cocoa dust.</p><p class="price">$3.95 <span class="badge warn">Nuts</span></p></li>
        <li class="card"><h3>Lemon Bar</h3><p>Tart curd, powdered sugar.</p><p class="price">$3.50</p></li>
        <li class="card"><h3>Macaron 3-pack</h3><p>Rotating flavors.</p><p class="price">$5.50</p></li>
        <li class="card"><h3>Cold-Brew Float</h3><p>Creamy soft-serve + bold brew.</p><p class="price">$5.75 <span class="badge">DF</span></p></li>
      </ul>
    </div>
  </section>

  <!-- Spinner / Promo -->
  <section id="deals" class="section" aria-labelledby="deals-title">
    <div class="wrap deals-grid">
      <div>
        <h2 id="deals-title">Sweet Wheels, Sweet Deals</h2>
        <p class="muted">One spin per guest per day. Show your win screen at checkout. Not stackable; valid today only.</p>
        <div class="spinner card" aria-live="polite">
          <div class="stage">
            <div class="rim" aria-hidden="true"></div>
            <div class="canvas-wrap">
              <span class="pointer" aria-hidden="true"></span>
              <canvas id="wheel" width="420" height="420" role="img" aria-label="Prize wheel: spin to reveal your deal"></canvas>
            </div>
          </div>
          <div class="controls">
            <button id="spinBtn" class="btn">Spin</button>
            <button id="resetBtn" class="btn" type="button">Reset (dev)</button>
          </div>
          <p id="spinNote" class="muted small"></p>
        </div>
      </div>

      <aside class="card" aria-live="polite">
        <h3 style="margin-top:0">Your prize</h3>
        <p id="winText" class="muted">Spin to see what you get!</p>
        <p id="winCode" class="coupon" title="Click to copy" hidden>Code: SWEET-00000</p>
      </aside>
    </div>
  </section>

  <!-- Quick Questions -->
  <section id="contact" class="section" aria-labelledby="qq-title">
    <div class="wrap grid2">
      <div>
        <h2 id="qq-title">Quick Questions</h2>
        <p class="muted">Ask us anything‚Äîpreorders, allergies, flavors today.</p>
        <form id="qq-form" class="card form" novalidate>
          <label> Name <input required name="name" autocomplete="name" /></label>
          <label> Email or Phone <input required name="contact" autocomplete="email" inputmode="email" /></label>
          <label> Message <textarea required name="message" rows="3" placeholder="Your question‚Ä¶"></textarea></label>
          <button class="btn" type="submit">Send</button>
          <p id="qq-status" class="muted small" role="status" aria-live="polite"></p>
        </form>
      </div>

      <div>
        <h2 id="reviews">Reviews</h2>
        <blockquote class="card quote">‚ÄúThe lemon bars are sunshine!‚Äù ‚Äî Mia ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</blockquote>
        <blockquote class="card quote">‚ÄúBest brownie in town.‚Äù ‚Äî Jay ‚≠ê‚≠ê‚≠ê‚≠ê‚≠ê</blockquote>
        <h3 class="mt">Instagram</h3>
        <ul class="ig"><li class="ph"></li><li class="ph"></li><li class="ph"></li><li class="ph"></li><li class="ph"></li><li class="ph"></li></ul>
        <p class="muted small">Follow us: @sweetwheels ‚Ä¢ Facebook ‚Ä¢ Foursquare</p>
      </div>
    </div>
  </section>

  <!-- FAQ -->
  <section id="faq" class="section" aria-labelledby="faq-title">
    <div class="wrap">
      <h2 id="faq-title">FAQ</h2>
      <details class="card"><summary>Allergens</summary><p>Badges show GF, DF, V, and Nuts. Ask us anytime.</p></details>
      <details class="card"><summary>Payments</summary><p>Cards, tap-to-pay, and cash.</p></details>
      <details class="card" id="hours"><summary>Weather & Hours</summary><p>We post today‚Äôs hours and location up top by 10am.</p></details>
    </div>
  </section>

  <footer class="footer">
    <div class="wrap">
      <p>¬© <span id="year"></span> Sweet Wheels. Made with üíó & sugar.</p>
      <nav class="mini-nav"><a href="#">Privacy</a><a href="#">Permits</a><a href="#contact">Contact</a></nav>
    </div>
  </footer>

  <nav class="sticky-cta" aria-label="Primary">
    <a href="#find" class="btn mini">Find Us</a>
    <a href="#menu" class="btn mini line">Menu</a>
    <a href="#order" class="btn mini">Order</a>
  </nav>
</section>

<!-- GSAP first -->
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/gsap/2.1.3/TweenMax.min.js" integrity="sha512-58H8hNtFZgJrFGh8VxBz4C4N9GJ2z8Qh6u2X6xU5iBNkWzA8FcJ6r9tWkGNT2l5m6ZzC2Kic4qK2C6cYcZ7Yxw==" crossorigin="anonymous" referrerpolicy="no-referrer"></script>

<script>
/* ======= Topbar & basics ======= */
const schedule = [
  {day:"Sunday",    place:"Market Square",  hours:"12‚Äì6 PM"},
  {day:"Monday",    place:"Closed",         hours:"‚Äî"},
  {day:"Tuesday",   place:"Old City",       hours:"11‚Äì3 PM"},
  {day:"Wednesday", place:"UT Campus",      hours:"12‚Äì5 PM"},
  {day:"Thursday",  place:"Fountain City",  hours:"12‚Äì6 PM"},
  {day:"Friday",    place:"Downtown",       hours:"1‚Äì8 PM"},
  {day:"Saturday",  place:"Farmer‚Äôs Market",hours:"9‚Äì2 PM"}
];
(function initTopbar(){
  const today = new Date().getDay(), item = schedule[today], pill = document.getElementById('today-pill');
  const text = item.place === "Closed" ? "Closed" : `<a href="https://maps.google.com/?q=${encodeURIComponent(item.place)}" target="_blank" rel="noopener">${item.place}</a>`;
  pill.innerHTML = `Today: ${text} ‚Ä¢ ${item.hours}`;
  document.getElementById('hoursList').innerHTML = schedule.map((d,i)=>{
    const label = `${d.day.slice(0,3)} ‚Äî ${d.place} ‚Ä¢ ${d.hours}${i===today?' (today)':''}`;
    return `<li>${i===today?'<strong>'+label+'</strong>':label}</li>`;
  }).join('');
})();
document.getElementById('year').textContent = new Date().getFullYear();
document.getElementById('qq-form').addEventListener('submit', e => {
  e.preventDefault(); document.getElementById('qq-status').textContent="Thanks! We‚Äôll reply as soon as we park the truck."; e.target.reset();
});

/* ======= Spinner (robust boot) ======= */
const prizes = ["10% OFF","Free Topping","$1 Off Drink","BOGO 50%","Mystery Sweet"];
const colors = ["#F8B8C9","#BFEEDF","#BFD6FF","#DCC6FF","#FFE3A1"];
const prefersReduced = matchMedia('(prefers-reduced-motion: reduce)').matches;
const tick = new Audio('https://cdn.jsdelivr.net/gh/terkelg/experiments@master/sounds/tick.mp3'); tick.volume = 0.2;
const urlParams = new URLSearchParams(location.search);
const force = urlParams.get('force'); // "1..5" or label
let theWheel;

function todayKey(){ return new Date().toISOString().slice(0,10); }
function alreadySpun(){ return localStorage.getItem('sw_spin') === todayKey(); }
function setSpun(){ localStorage.setItem('sw_spin', todayKey()); }
function enableSpinUI(){ spinBtn.disabled=false; spinBtn.textContent='Spin'; note.textContent='Good luck!'; }
function disableSpinUI(){ spinBtn.disabled=true; spinBtn.textContent='Come back tomorrow'; note.textContent='One spin per guest per day.'; }

const spinBtn = document.getElementById('spinBtn');
const resetBtn = document.getElementById('resetBtn');
const note = document.getElementById('spinNote');
const winText = document.getElementById('winText');
const winCode = document.getElementById('winCode');

resetBtn.addEventListener('click', ()=>{ localStorage.removeItem('sw_spin'); enableSpinUI(); winText.textContent='Spin to see what you get!'; winCode.hidden=true; });

/* Load Winwheel with fallbacks, then init */
(async function bootSpinner(){
  await domReady();
  if (!window.TweenMax) { console.warn('TweenMax missing.'); }

  // Try primary CDN
  let loaded = await loadScript('https://cdn.jsdelivr.net/npm/winwheel@1.0.1/dist/Winwheel.min.js').catch(()=>false);
  // Fallbacks if needed
  if (!window.Winwheel) loaded = await loadScript('https://cdn.jsdelivr.net/gh/zarocknz/javascript-winwheel@master/Winwheel.min.js').catch(()=>false);
  if (!window.Winwheel) loaded = await loadScript('https://unpkg.com/winwheel@1.0.1/Winwheel.min.js').catch(()=>false);

  if (!window.Winwheel) {
    note.textContent = 'Spinner failed to load. Check your network/CDN and refresh.';
    console.error('Winwheel not available.');
    spinBtn.disabled = true;
    return;
  }

  buildWheel();
  alreadySpun() ? disableSpinUI() : enableSpinUI();
  spinBtn.addEventListener('click', spin);
  if (location.hash === '#reset'){ localStorage.removeItem('sw_spin'); enableSpinUI(); }
})();

function buildWheel(){
  const wrap = document.querySelector('.canvas-wrap');
  const canvas = document.getElementById('wheel');
  const cssSize = Math.max(260, wrap.clientWidth);
  const dpr = Math.max(1, Math.min(2, window.devicePixelRatio || 1)); // cap to 2

  canvas.width = Math.floor(cssSize * dpr);
  canvas.height = Math.floor(cssSize * dpr);
  canvas.style.width = cssSize + 'px';
  canvas.style.height = cssSize + 'px';

  const segments = prizes.map((t,i)=>({ fillStyle: colors[i], text: t, textFillStyle:"#5b5b66", strokeStyle:"#fff" }));
  theWheel = new Winwheel({
    canvasId:'wheel',
    numSegments: segments.length,
    outerRadius: (cssSize/2)-10,
    textFontFamily:'Fredoka, Arial, sans-serif',
    textAlignment:'outer',
    textMargin: Math.max(14, cssSize*0.07),
    segments,
    pins:{ number: Math.round(cssSize/16), fillStyle:'#fff', outerRadius:2 },
    animation:{
      type:'spinToStop',
      duration: prefersReduced?0.1:5,
      spins: prefersReduced?1:6,
      callbackFinished: announcePrize,
      callbackSound: ()=>{ try{ tick.currentTime=0; tick.play(); }catch(e){} },
      soundTrigger:'pin'
    }
  });
  const ctx = theWheel.ctx; ctx.setTransform(dpr,0,0,dpr,0,0); theWheel.draw();

  // rebuild on resize (debounced)
  let rz; addEventListener('resize', ()=>{ clearTimeout(rz); rz=setTimeout(buildWheel,200); }, {passive:true});
}

function pickIndex(){ return Math.floor(Math.random()*prizes.length); } // 0..4

function spin(){
  if (alreadySpun() || theWheel.animation.spinning) return;

  let index = pickIndex();
  if (force){
    const n = +force;
    if (n>=1 && n<=prizes.length) index = n-1;
    else {
      const i = prizes.findIndex(p => p.toLowerCase() === String(force).toLowerCase());
      if (i !== -1) index = i;
    }
  }
  const segNum = index + 1;
  theWheel.animation.stopAngle = theWheel.getRandomForSegment(segNum);

  console.log('[spin] forced?', !!force, 'index:', index, 'segNum:', segNum);
  console.log('[spin] stopAngle:', theWheel.animation.stopAngle);

  theWheel.startAnimation();
}

function announcePrize(){
  const seg = theWheel.getIndicatedSegment();
  console.log('[finish] rotationAngle:', theWheel.rotationAngle, 'indicated:', seg.text);

  winText.textContent = `üéâ ${seg.text}`;
  winCode.textContent = "Code: " + couponCode();
  winCode.hidden = false;
  setSpun(); disableSpinUI();
}

winCode.addEventListener('click', async ()=>{
  try{
    await navigator.clipboard.writeText(winCode.textContent.replace('Code: ',''));
    const t = winCode.textContent; winCode.textContent = t + '  ‚úì copied';
    setTimeout(()=> winCode.textContent = t, 1400);
  }catch{}
});

/* Test helper */
window.testSpins = function(n=1000){
  const counts = Object.fromEntries(prizes.map(p=>[p,0]));
  for(let i=0;i<n;i++){ counts[prizes[Math.floor(Math.random()*prizes.length)]]++; }
  console.table(counts); return counts;
};

/* Utils */
function couponCode(){ const s="ABCDEFGHJKLMNPQRSTUVWXYZ23456789"; let out="SWEET-"; for(let i=0;i<5;i++) out+=s[Math.floor(Math.random()*s.length)]; return out; }
function loadScript(src){ return new Promise((res,rej)=>{ const s=document.createElement('script'); s.src=src; s.defer=true; s.onload=()=>res(true); s.onerror=rej; document.head.appendChild(s); }); }
function domReady(){ return new Promise(r=>{ if (document.readyState!=='loading') r(); else addEventListener('DOMContentLoaded', r, {once:true}); }); }
</script>
</body>
</html>
